<section id="nice" data-tool="mdnice编辑器" data-website="https://www.mdnice.com" style="font-size: 16px; padding: 0 10px; word-spacing: 0px; word-break: break-word; word-wrap: break-word; text-align: left; line-height: 1.75; color: #595959; font-family: Optima-Regular, Optima, PingFangTC-Light, PingFangSC-light, PingFangTC-light; letter-spacing: 2px; background-image: linear-gradient(90deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%), linear-gradient(360deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%); background-size: 20px 20px; background-position: center center;"><h1 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 25px;"><span class="prefix" style="display: none;"></span><span class="content" style="display: inline-block; font-weight: bold; color: #595959;">HOC</span><span class="suffix"></span></h1>
<h2 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 22px; text-align: left; margin: 20px 10px 0px 0px;"><span class="prefix" style="display: none;"></span><span class="content" style="font-size: 18px; font-weight: bold; display: inline-block; padding-left: 10px; border-left: 5px solid #DEC6FB; color: #595959;">前言</span><span class="suffix"></span></h2>
<p data-tool="mdnice编辑器" style="padding-top: 8px; padding-bottom: 8px; line-height: 26px; color: #595959; margin: 10px 0px; letter-spacing: 2px; font-size: 14px; word-spacing: 2px;">HOC 即为 高阶组件（higher-order component），是 React 中<code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: #595959;">用于复用组件逻辑</code>的一种<em style="font-style: normal; color: #595959; background: #F6EEFF;">高级技巧</em></p>
<p data-tool="mdnice编辑器" style="padding-top: 8px; padding-bottom: 8px; line-height: 26px; color: #595959; margin: 10px 0px; letter-spacing: 2px; font-size: 14px; word-spacing: 2px;">是一种基于 React 的组合特性而形成的设计模式</p>
<p data-tool="mdnice编辑器" style="padding-top: 8px; padding-bottom: 8px; line-height: 26px; color: #595959; margin: 10px 0px; letter-spacing: 2px; font-size: 14px; word-spacing: 2px;">高阶组件是参数为组件，返回值为<code style="font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: #595959;">新组件</code>的函数</p>
<h2 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 22px; text-align: left; margin: 20px 10px 0px 0px;"><span class="prefix" style="display: none;"></span><span class="content" style="font-size: 18px; font-weight: bold; display: inline-block; padding-left: 10px; border-left: 5px solid #DEC6FB; color: #595959;">举个栗子</span><span class="suffix"></span></h2>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #abb2bf; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #282c34; border-radius: 5px;"><span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">import</span>&nbsp;getFullName&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">from</span>&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">from</span>&nbsp;<span class="hljs-string" style="color: #98c379; line-height: 26px;">'xxx'</span>;<br><br><span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">interface</span>&nbsp;IWrappedProps&nbsp;{<br>&nbsp;&nbsp;single:&nbsp;<span class="hljs-built_in" style="color: #e6c07b; line-height: 26px;">boolean</span>;<br>&nbsp;&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">type</span>:&nbsp;<span class="hljs-built_in" style="color: #e6c07b; line-height: 26px;">string</span>;<br>}<br><br><span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">interface</span>&nbsp;IProps&nbsp;{<br>&nbsp;&nbsp;firstName:&nbsp;<span class="hljs-built_in" style="color: #e6c07b; line-height: 26px;">string</span>;<br>&nbsp;&nbsp;age:&nbsp;<span class="hljs-built_in" style="color: #e6c07b; line-height: 26px;">number</span>;<br>&nbsp;&nbsp;talk:&nbsp;<span class="hljs-function" style="line-height: 26px;">(<span class="hljs-params" style="line-height: 26px;">...arg</span>)&nbsp;=&gt;</span>&nbsp;<span class="hljs-built_in" style="color: #e6c07b; line-height: 26px;">void</span>;<br>}<br><br><br><span class="hljs-function" style="line-height: 26px;"><span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">function</span>&nbsp;<span class="hljs-title" style="color: #61aeee; line-height: 26px;">withFullName</span>(<span class="hljs-params" style="line-height: 26px;">WrappedComponent:&nbsp;React.Element.ElementType,&nbsp;wrappedProps:&nbsp;IWrappedProps,</span>)&nbsp;</span>{&nbsp;<span class="hljs-comment" style="color: #5c6370; font-style: italic; line-height: 26px;">//&nbsp;可以混入你需要的props</span><br>&nbsp;&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">return</span>&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">class</span>&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">extends</span>&nbsp;Component&lt;IProps&gt;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">const</span>&nbsp;{firstName,&nbsp;age,&nbsp;talk}&nbsp;=&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">this</span>.props;<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">const</span>&nbsp;text&nbsp;=&nbsp;getFullName(firstName,&nbsp;age);&nbsp;<span class="hljs-comment" style="color: #5c6370; font-style: italic; line-height: 26px;">//可以做一些复用的逻辑</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">const</span>&nbsp;componentProps&nbsp;=&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...wrappedProps,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;firstName,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;age,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;talk,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text,<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">return</span>&nbsp;(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;className=<span class="hljs-string" style="color: #98c379; line-height: 26px;">"wrappe"</span>&gt;&nbsp;<span class="hljs-comment" style="color: #5c6370; font-style: italic; line-height: 26px;">//&nbsp;可以嵌套一些样式</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;WrappedComponent&nbsp;{...componentProps}/&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;<span class="hljs-regexp" style="color: #98c379; line-height: 26px;">/div&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>&nbsp;&nbsp;}<br>}<br><br></span></code></pre>
<h2 data-tool="mdnice编辑器" style="margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 22px; text-align: left; margin: 20px 10px 0px 0px;"><span class="prefix" style="display: none;"></span><span class="content" style="font-size: 18px; font-weight: bold; display: inline-block; padding-left: 10px; border-left: 5px solid #DEC6FB; color: #595959;">埋点</span><span class="suffix"></span></h2>
<pre class="custom" data-tool="mdnice编辑器" style="margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><span style="display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;"></span><code class="hljs" style="overflow-x: auto; padding: 16px; color: #abb2bf; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #282c34; border-radius: 5px;">埋点HOC<br>define<br>import&nbsp;React&nbsp;from&nbsp;<span class="hljs-string" style="color: #98c379; line-height: 26px;">'react'</span><br>import&nbsp;{&nbsp;setSpm&nbsp;}&nbsp;from&nbsp;<span class="hljs-string" style="color: #98c379; line-height: 26px;">'xxx'</span><br>import&nbsp;ImmutableComponent&nbsp;from&nbsp;<span class="hljs-string" style="color: #98c379; line-height: 26px;">'immutable-component'</span><br><span class="hljs-built_in" style="color: #e6c07b; line-height: 26px;">export</span>&nbsp;const&nbsp;SetSpm&nbsp;=&nbsp;(spmConfig&nbsp;=&nbsp;[])&nbsp;=&gt;&nbsp;(WrappedComponent)&nbsp;=&gt;&nbsp;class&nbsp;extends&nbsp;ImmutableComponent&nbsp;{<br>&nbsp;&nbsp;<span class="hljs-function" style="line-height: 26px;"><span class="hljs-title" style="color: #61aeee; line-height: 26px;">componentDidMount</span></span>()&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;setSpm(spmConfig)<br>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;didUpdate&nbsp;=&nbsp;WrappedComponent.prototype.componentDidUpdate<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;eslint-disable-next-line&nbsp;no-param-reassign<br>&nbsp;&nbsp;&nbsp;&nbsp;WrappedComponent.prototype.componentDidUpdate&nbsp;=&nbsp;(prevProps,&nbsp;prevState)&nbsp;=&gt;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setSpm(spmConfig)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="color: #c678dd; line-height: 26px;">if</span>&nbsp;(didUpdate)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;didUpdate.call(this,&nbsp;prevProps,&nbsp;prevState)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;}<br>&nbsp;&nbsp;<span class="hljs-function" style="line-height: 26px;"><span class="hljs-title" style="color: #61aeee; line-height: 26px;">render</span></span>()&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in" style="color: #e6c07b; line-height: 26px;">return</span>&nbsp;&lt;WrappedComponent&nbsp;{...this.props}&nbsp;/&gt;<br>&nbsp;&nbsp;}<br>}<br>Usage<br>import&nbsp;spmConfig&nbsp;from&nbsp;<span class="hljs-string" style="color: #98c379; line-height: 26px;">'xxx'</span><br>@SetSpm(spmConfig)<br>class&nbsp;FirstGift&nbsp;extends&nbsp;ImmutableComponent&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;something...<br>}<br><span class="hljs-built_in" style="color: #e6c07b; line-height: 26px;">export</span>&nbsp;default&nbsp;FirstGift<br><br></code></pre>
</section>